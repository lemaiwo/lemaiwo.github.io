{"version":3,"file":"Base-dbg.controller.js","names":["_catch","body","recover","result","e","then","_fragments","Base","Controller","extend","getMainView","_getMainView","getView","viewController","onExit","_onExit","onBook","_onBook","topic","_this","Promise","resolve","openFragment","name","data","_this$openFragment","closeResult","reject","_openFragment","config","_temp4","closedPromise","id","controller","_this2","onBeforeShow","popoverSource","fragment","openBy","open","viewName","indexOf","split","substr","lastIndexOf","getViewName","pop","viewPath","join","controllerPath","replace","getId","_temp3","_temp2","Fragment","load","newController","_Fragment$load","newFragment","addDependent","_temp","create","_Controller$create"],"sources":["Base.controller.ts"],"sourcesContent":["import Dialog from \"sap/m/Dialog\";\nimport Popover from \"sap/m/Popover\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport Fragment from \"sap/ui/core/Fragment\";\nimport Controller from \"sap/ui/core/mvc/Controller\";\nimport View from \"sap/ui/core/mvc/View\";\nimport DialogController from \"./Dialog.controller\";\n\nexport type frag = {\n\tcontroller: DialogController;\n\tfragment: Fragment;\n};\ntype frags = Record<string, frag>;\nlet _fragments: frags = {};\n/**\n * @namespace be.wl.lemtech.wouter.controller\n */\nexport default class Base extends Controller {\n\tprotected viewController: Controller;\n\n\tpublic getMainView() {\n\t\treturn this.getView() || this.viewController.getView();\n\t}\n\tpublic onExit(): void {\n\t\t_fragments = {};\n\t}\n\tpublic async onBook(topic: string) {\n\t\tconst closeResult = (await this.openFragment({\n\t\t\tname: \"be.wl.lemtech.wouter.view.dialog.Book\",\n\t\t\tdata: { topic: topic || \"\" }\n\t\t})) as string;\n\t}\n\n\tpublic async openFragment(config: { name: string; data?: unknown; popoverSource?: Popover }): Promise<unknown> {\n\t\tlet viewName: string[];\n\t\tif (config.name.indexOf(\".\") > 0) {\n\t\t\t//full path\n\t\t\tviewName = config.name.split(\".\");\n\t\t\tconfig.name = config.name.substr(config.name.lastIndexOf(\".\") + 1);\n\t\t} else {\n\t\t\t//current folder\n\t\t\tviewName = this.getMainView()!.getViewName().split(\".\");\n\t\t}\n\t\tviewName.pop();\n\t\tconst viewPath = viewName.join(\".\") + \".\",\n\t\t\tcontrollerPath = viewPath.replace(\"view\", \"controller\"),\n\t\t\tid = this.getMainView()!.getId() + \"--\" + config.name;\n\t\tif (!_fragments[id]) {\n\t\t\tlet newController: Controller;\n\t\t\ttry {\n\t\t\t\tnewController = (await Controller.create({\n\t\t\t\t\tname: controllerPath + config.name\n\t\t\t\t})) as Controller;\n\t\t\t} catch (error) {\n\t\t\t\t// console.log(\"Dialog without controller. Just continue with the current controller for the dialog\");\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tnewController = this;\n\t\t\t}\n\t\t\tconst newFragment = (await Fragment.load({\n\t\t\t\tid: id,\n\t\t\t\tname: viewPath + config.name,\n\t\t\t\tcontroller: newController\n\t\t\t})) as unknown as Fragment;\n\t\t\t_fragments[id] = { controller: newController as DialogController, fragment: newFragment };\n\t\t\tthis.getMainView()!.addDependent(_fragments[id].fragment as unknown as UI5Element);\n\t\t}\n\t\tconst closedPromise = new Promise((resolve, reject) => {\n\t\t\tif (_fragments[id].controller && (_fragments[id].controller as Controller) !== this) {\n\t\t\t\tif (\"onBeforeShow\" in _fragments[id].controller) {\n\t\t\t\t\t_fragments[id].controller.onBeforeShow(this, _fragments[id], resolve, config.data, config.popoverSource);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (config.popoverSource) {\n\t\t\t(_fragments[id].fragment as unknown as Popover).openBy(config.popoverSource, false);\n\t\t} else {\n\t\t\t(_fragments[id].fragment as Dialog).open();\n\t\t}\n\t\treturn closedPromise; //_fragments[id].fragment;\n\t}\n}"],"mappings":"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"}